{
  "description": "Business logic vulnerability patterns for agent analysis",
  "version": "1.0",
  "patterns": {
    "authorization_bypass": {
      "name": "Authorization Bypass",
      "description": "Users can access resources they shouldn't have access to",
      "test_strategy": "Create user A, try to access user B's resources using various endpoint manipulations",
      "indicators": [
        "user_id", "owner_id", "created_by", "author_id", "account_id",
        "profile_id", "team_id", "project_id", "organization_id"
      ],
      "vulnerable_patterns": [
        "Resource endpoints that accept user identifiers in URL/parameters",
        "Missing ownership validation in resource access",
        "Predictable resource identifiers (sequential, UUID-based)",
        "Inconsistent authorization checks across similar endpoints"
      ],
      "common_endpoints": [
        "GET /users/{id}/profile",
        "GET /users/{id}/posts",
        "GET /users/{id}/files",
        "PUT /posts/{id}",
        "DELETE /files/{id}",
        "GET /admin/users/{id}"
      ],
      "test_cases": [
        {
          "description": "Direct resource access with different user ID",
          "method": "Modify resource identifiers in requests to access other users' data",
          "payload_variations": [
            {"user_id": "other_user_id"},
            {"owner": "other_user_id"},
            {"account_id": "other_user_id"}
          ]
        },
        {
          "description": "ID enumeration attacks",
          "method": "Sequentially try resource IDs to find unprotected resources",
          "payload_variations": [
            {"id": 1, "id": 2, "id": 3, "id": 999, "id": 1000}
          ]
        },
        {
          "description": "Parameter pollution",
          "method": "Send multiple user identifier parameters",
          "payload_variations": [
            {"user_id": "my_id", "owner_id": "other_id"},
            {"user_id": ["my_id", "other_id"]}
          ]
        }
      ]
    },
    "state_manipulation": {
      "name": "State Manipulation",
      "description": "Application state can be modified through unauthorized parameter changes",
      "test_strategy": "Try to modify application state parameters that should be server-controlled",
      "indicators": [
        "status", "state", "approved", "verified", "active", "enabled",
        "paid", "completed", "published", "archived", "deleted", "banned"
      ],
      "vulnerable_patterns": [
        "Client-side state control in requests",
        "Missing server-side validation for state changes",
        "Business logic flows that can be bypassed",
        "Race conditions in state transitions"
      ],
      "common_endpoints": [
        "POST /orders",
        "PUT /users/{id}/status",
        "POST /payments",
        "PUT /posts/{id}/publish",
        "POST /workflows/{step}"
      ],
      "test_cases": [
        {
          "description": "Unauthorized status changes",
          "method": "Try to change resource status through API calls",
          "payload_variations": [
            {"status": "approved", "active": true},
            {"verified": true, "enabled": true},
            {"paid": true, "completed": true}
          ]
        },
        {
          "description": "Workflow bypass",
          "method": "Skip intermediate workflow steps",
          "payload_variations": [
            {"step": "final", "skip_validation": true},
            {"workflow_id": "complete", "bypass_checks": true}
          ]
        }
      ]
    },
    "privilege_escalation": {
      "name": "Privilege Escalation",
      "description": "Users can elevate their privileges or access admin functionality",
      "test_strategy": "Test for ways to gain elevated privileges or admin access",
      "indicators": [
        "role", "admin", "moderator", "superuser", "root",
        "permissions", "access_level", "privileges", "is_admin",
        "can_edit", "can_delete", "can_manage"
      ],
      "vulnerable_patterns": [
        "Missing role validation in privileged operations",
        "Weak role assignment mechanisms",
        "Privilege escalation through parameter manipulation",
        "Inconsistent permission checks"
      ],
      "common_endpoints": [
        "POST /users/{id}/role",
        "PUT /users/{id}/permissions",
        "GET /admin/dashboard",
        "POST /admin/users",
        "DELETE /admin/content/{id}"
      ],
      "test_cases": [
        {
          "description": "Role parameter manipulation",
          "method": "Try to modify role-related parameters",
          "payload_variations": [
            {"role": "admin", "permissions": ["all"]},
            {"is_admin": true, "access_level": "superuser"},
            {"can_edit": true, "can_delete": true}
          ]
        },
        {
          "description": "Admin endpoint access",
          "method": "Try to access admin-specific endpoints with regular user permissions",
          "payload_variations": [
            "Direct access to /admin/* endpoints",
            "Add admin parameters to regular requests"
          ]
        }
      ]
    },
    "resource_exhaustion": {
      "name": "Resource Exhaustion",
      "description": "Application can be overwhelmed through resource abuse",
      "test_strategy": "Test limits and try to exhaust system resources",
      "indicators": [
        "limit", "max", "quota", "rate", "throttle",
        "concurrent", "batch", "bulk", "size", "count"
      ],
      "vulnerable_patterns": [
        "Missing rate limiting on resource-intensive operations",
        "Unbounded resource consumption",
        "Inadequate quota enforcement",
        "Missing input size validation"
      ],
      "common_endpoints": [
        "POST /files/upload",
        "POST /api/bulk",
        "GET /api/export",
        "POST /search",
        "GET /reports/generate"
      ],
      "test_cases": [
        {
          "description": "Large payload attacks",
          "method": "Send oversized requests to test limits",
          "payload_variations": [
            "Large JSON objects (10MB+)",
            "Deeply nested structures",
            "Long string values"
          ]
        },
        {
          "description": "Rate limit bypass",
          "method": "Send rapid requests to overwhelm the system",
          "payload_variations": [
            "Parallel requests with different sessions",
            "Header manipulation to bypass limits"
          ]
        }
      ]
    },
    "race_conditions": {
      "name": "Race Conditions",
      "description": "Concurrent operations can exploit timing vulnerabilities",
      "test_strategy": "Send simultaneous requests to exploit timing issues",
      "indicators": [
        "balance", "credit", "count", "stock", "inventory",
        "available", "remaining", "limit", "quota", "counter"
      ],
      "vulnerable_patterns": [
        "Non-atomic operations on shared resources",
        "Read-modify-write vulnerabilities",
        "Missing transaction isolation",
        "Inadequate locking mechanisms"
      ],
      "common_endpoints": [
        "POST /purchases",
        "POST /transfer",
        "PUT /inventory/{id}",
        "POST /redeem",
        "POST /claim"
      ],
      "test_cases": [
        {
          "description": "Concurrent purchase attempts",
          "method": "Send simultaneous requests for limited resources",
          "payload_variations": [
            "Multiple rapid purchase requests for same item",
            "Concurrent balance transfers"
          ]
        }
      ]
    },
    "workflow_circumvention": {
      "name": "Workflow Circumvention",
      "description": "Business workflows can be bypassed or manipulated",
      "test_strategy": "Try to skip or manipulate business process steps",
      "indicators": [
        "workflow", "process", "step", "stage", "phase",
        "approval", "review", "validation", "verification", "audit"
      ],
      "vulnerable_patterns": [
        "Client-side workflow control",
        "Missing server-side validation of process steps",
        "Inadequate enforcement of business rules",
        "Weak audit trails"
      ],
      "common_endpoints": [
        "POST /workflows/{id}/advance",
        "PUT /processes/{id}/step",
        "POST /approvals",
        "POST /reviews",
        "POST /audits"
      ],
      "test_cases": [
        {
          "description": "Step skipping",
          "method": "Try to advance to final workflow steps directly",
          "payload_variations": [
            {"step": "final", "bypass_intermediate": true},
            {"workflow_id": "complete", "skip_validation": true}
          ]
        }
      ]
    },
    "data_integrity": {
      "name": "Data Integrity Violations",
      "description": "Data can be modified or corrupted through API manipulation",
      "test_strategy": "Test for ways to corrupt or modify protected data",
      "indicators": [
        "checksum", "hash", "signature", "integrity", "verified",
        "immutable", "locked", "protected", "sealed"
      ],
      "vulnerable_patterns": [
        "Missing data integrity checks",
        "Weak validation of data modifications",
        "Inadequate protection of immutable data",
        "Missing audit logging for data changes"
      ],
      "common_endpoints": [
        "PUT /data/{id}",
        "POST /data/modify",
        "PUT /records/{id}",
        "POST /logs/create",
        "PUT /audit/{id}"
      ],
      "test_cases": [
        {
          "description": "Immutable data modification",
          "method": "Try to modify data that should be immutable",
          "payload_variations": [
            {"timestamp": "modified_value", "verified": false},
            {"immutable_field": "changed_value"}
          ]
        }
      ]
    }
  },
  "testing_guidance": {
    "general_approach": [
      "Map all endpoints and their expected behaviors",
      "Identify business entities and their relationships",
      "Test authorization patterns across all entity types",
      "Verify state management and workflow enforcement",
      "Test edge cases and boundary conditions"
    ],
    "success_indicators": [
      "Unauthorized access to resources",
      "Ability to modify application state illegitimately",
      "Privilege escalation successful",
      "Resource limits bypassed",
      "Business rules circumvented"
    ],
    "false_positive_indicators": [
      "Proper error responses with no data leakage",
      "Consistent 401/403 responses for unauthorized access",
      "Rate limiting active and effective",
      "Audit logs properly generated"
    ]
  }
}