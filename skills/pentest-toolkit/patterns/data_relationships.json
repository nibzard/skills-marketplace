{
  "description": "Common data relationship patterns for application structure analysis",
  "version": "1.0",
  "relationships": {
    "user_centric": {
      "description": "Patterns centered around user entities",
      "primary_entities": ["user", "account", "profile"],
      "common_relationships": [
        {
          "type": "one_to_many",
          "from": "user",
          "to": ["posts", "comments", "files", "orders", "notifications"],
          "indicators": ["user_id", "owner_id", "author_id", "created_by"]
        },
        {
          "type": "many_to_many",
          "from": "user",
          "to": ["teams", "groups", "roles", "permissions"],
          "indicators": ["user_teams", "user_groups", "user_roles", "junction_tables"]
        },
        {
          "type": "one_to_one",
          "from": "user",
          "to": ["profile", "settings", "preferences"],
          "indicators": ["user_profile", "user_settings", "profile_id"]
        }
      ],
      "security_implications": [
        "Authorization bypass through user_id manipulation",
        "Horizontal privilege escalation between users",
        "Data leakage through inadequate user isolation"
      ]
    },
    "content_management": {
      "description": "Content and media management patterns",
      "primary_entities": ["post", "article", "page", "media", "file"],
      "common_relationships": [
        {
          "type": "many_to_one",
          "from": ["post", "article", "comment"],
          "to": ["user", "category", "section"],
          "indicators": ["author_id", "user_id", "category_id", "section_id"]
        },
        {
          "type": "many_to_many",
          "from": ["post", "article"],
          "to": ["tags", "categories", "media"],
          "indicators": ["post_tags", "article_media", "junction_tables"]
        },
        {
          "type": "hierarchical",
          "from": ["category", "section", "comment"],
          "to": ["same_type"],
          "indicators": ["parent_id", "hierarchy_level", "path"]
        }
      ],
      "security_implications": [
        "Unauthorized content modification",
        "Content injection through relationship manipulation",
        "Privilege escalation in content management"
      ]
    },
    "ecommerce": {
      "description": "E-commerce and transaction patterns",
      "primary_entities": ["order", "product", "cart", "payment", "inventory"],
      "common_relationships": [
        {
          "type": "many_to_one",
          "from": ["order", "cart_item", "review"],
          "to": ["user", "product", "store"],
          "indicators": ["user_id", "product_id", "store_id", "customer_id"]
        },
        {
          "type": "one_to_many",
          "from": ["order", "product"],
          "to": ["order_items", "reviews", "inventory"],
          "indicators": ["order_id", "product_id", "parent_order", "parent_product"]
        },
        {
          "type": "many_to_many",
          "from": ["product", "order"],
          "to": ["categories", "tags", "promotions"],
          "indicators": ["product_categories", "order_promotions"]
        }
      ],
      "security_implications": [
        "Price manipulation through relationship tampering",
        "Order interception and modification",
        "Inventory manipulation attacks"
      ]
    },
    "project_management": {
      "description": "Project and team management patterns",
      "primary_entities": ["project", "task", "team", "workspace"],
      "common_relationships": [
        {
          "type": "many_to_one",
          "from": ["task", "issue", "comment"],
          "to": ["project", "user", "assignee"],
          "indicators": ["project_id", "user_id", "assignee_id", "creator_id"]
        },
        {
          "type": "many_to_many",
          "from": ["user", "project"],
          "to": ["teams", "roles", "permissions"],
          "indicators": ["user_teams", "project_teams", "team_memberships"]
        },
        {
          "type": "hierarchical",
          "from": ["task", "project"],
          "to": ["same_type"],
          "indicators": ["parent_id", "subtasks", "milestone_id"]
        }
      ],
      "security_implications": [
        "Cross-project data access",
        "Task assignment manipulation",
        "Team privilege escalation"
      ]
    },
    "social_platforms": {
      "description": "Social media and communication patterns",
      "primary_entities": ["user", "post", "comment", "message", "relationship"],
      "common_relationships": [
        {
          "type": "many_to_many",
          "from": ["user"],
          "to": ["followers", "following", "friends", "groups"],
          "indicators": ["user_followers", "user_following", "friendships", "group_members"]
        },
        {
          "type": "many_to_one",
          "from": ["post", "comment", "like"],
          "to": ["user", "post", "conversation"],
          "indicators": ["user_id", "post_id", "conversation_id", "author_id"]
        },
        {
          "type": "self_referential",
          "from": ["user"],
          "to": ["user"],
          "indicators": ["blocked_users", "muted_users", "restricted_users"]
        }
      ],
      "security_implications": [
        "Privacy bypass through relationship manipulation",
        "Message interception",
        "Social engineering through data exposure"
      ]
    },
    "financial_systems": {
      "description": "Financial and banking patterns",
      "primary_entities": ["account", "transaction", "balance", "investment", "transfer"],
      "common_relationships": [
        {
          "type": "many_to_one",
          "from": ["transaction", "balance", "investment"],
          "to": ["account", "user"],
          "indicators": ["account_id", "user_id", "owner_id", "customer_id"]
        },
        {
          "type": "one_to_many",
          "from": ["account", "transaction"],
          "to": ["balances", "transactions", "transfers"],
          "indicators": ["account_balances", "related_transactions", "transaction_history"]
        },
        {
          "type": "many_to_many",
          "from": ["user", "account"],
          "to": ["permissions", "access_rights", "beneficiaries"],
          "indicators": ["account_permissions", "authorized_users", "beneficiary_relationships"]
        }
      ],
      "security_implications": [
        "Transaction manipulation",
        "Balance tampering",
        "Unauthorized account access",
        "Financial fraud through relationship abuse"
      ]
    }
  },
  "relationship_indicators": {
    "foreign_key_patterns": [
      "_id$", "id$", "uid$", "uuid$", "guid$",
      "ref$", "fk$", "parent$", "child$"
    ],
    "junction_table_patterns": [
      "_join$", "_link$", "_map$", "_relation$",
      "_membership$", "_association$", "_connection$"
    ],
    "hierarchical_patterns": [
      "parent_id", "child_id", "level", "depth",
      "path", "lft", "rgt", "tree_"
    ],
    "ownership_patterns": [
      "owner_id", "created_by", "author_id", "user_id",
      "account_id", "customer_id", "tenant_id"
    ],
    "many_to_many_indicators": [
      "pivot_", "bridge_", "mapping_", "linking_",
      "association_", "junction_", "xref_"
    ]
  },
  "vulnerability_patterns": {
    "insecure_direct_object_references": {
      "description": "IDOR vulnerabilities through relationship abuse",
      "indicators": [
        "Predictable resource IDs",
        "Missing ownership checks",
        "Sequential identifiers",
        "UUID patterns that can be guessed"
      ],
      "test_approaches": [
        "Resource ID enumeration",
        "Cross-tenant data access",
        "User switching attacks"
      ]
    },
    "relationship_injection": {
      "description": "Injecting malicious relationship data",
      "indicators": [
        "Client-controlled relationship parameters",
        "Unvalidated foreign key input",
        "Missing referential integrity checks"
      ],
      "test_approaches": [
        "Foreign key manipulation",
        "Invalid relationship injection",
        "Circular relationship creation"
      ]
    },
    "privilege_escalation_via_relationships": {
      "description": "Using relationships to gain elevated access",
      "indicators": [
        "Role-based relationships",
        "Team/group memberships",
        "Permission assignments"
      ],
      "test_approaches": [
        "Self-role assignment",
        "Team membership manipulation",
        "Permission inheritance abuse"
      ]
    }
  },
  "testing_strategies": {
    "relationship_mapping": [
      "Map all entity relationships from API responses",
      "Identify foreign key patterns and their validation",
      "Test relationship boundaries and access controls",
      "Verify referential integrity enforcement"
    ],
    "access_control_testing": [
      "Test cross-entity access patterns",
      "Verify ownership-based authorization",
      "Test relationship-based permission inheritance",
      "Check for privilege escalation through relationships"
    ],
    "data_integrity_validation": [
      "Test relationship manipulation attempts",
      "Verify foreign key constraints",
      "Test for orphaned record creation",
      "Check cascade operation security"
    ]
  }
}