# AI-Powered Security Testing Toolkit

A comprehensive, self-contained penetration testing toolkit that provides professional security testing capabilities with Astral uv for modern Python environment management. This skill implements core functionality based on the Apex security testing methodology.

**License**: MIT License - Free for commercial and personal use

## Using as a Claude Skill

In Claude Code, simply invoke the skill:

```bash
skill: "pentest-toolkit"
```

Then provide the target URL and testing mode when prompted. This is the recommended way to use the toolkit.

## Quick Start

```bash
# Make the toolkit executable
chmod +x pentest-toolkit

# Setup uv environment (recommended)
./pentest-toolkit --setup

# Run a quick security scan
./pentest-toolkit --target https://example.com --mode quick

# Run comprehensive penetration test
./pentest-toolkit --target https://example.com --mode comprehensive

# List all available tools
./pentest-toolkit --list-tools

# Show usage examples
./pentest-toolkit --examples
```

## Installation

### Requirements
- Python 3.8 or higher
- Optional: Astral uv (auto-installed if needed)

### Setup Methods

**1. Self-Contained (No uv)**
```bash
# Clone and run directly
git clone https://github.com/your-username/pentest-toolkit
cd pentest-toolkit
chmod +x pentest-toolkit
./pentest-toolkit --target https://example.com --mode quick
```

**2. With uv (Recommended)**
```bash
# Clone and setup with uv
git clone https://github.com/your-username/pentest-toolkit
cd pentest-toolkit
chmod +x pentest-toolkit
# Run directly - uv will be installed automatically if needed
./pentest-toolkit --target https://example.com --mode quick
```

### uv Benefits
- **Isolated Environment**: Each test runs in isolated virtual environment
- **Fast Execution**: uv's optimized Python package management
- **Auto-Installation**: Automatically installs if not present
- **Fallback Support**: Gracefully uses system Python if uv unavailable

## Features

### üîç Discovery Tools
- **Endpoint Enumeration** - Discovers URLs, APIs, and attack surfaces
- **Port Scanning** - Identifies open ports and services
- **Technology Fingerprinting** - Detects frameworks and versions

### üéØ Vulnerability Testing
- **SQL Injection** - Multiple injection techniques (blind, union, time-based)
- **Cross-Site Scripting (XSS)** - Reflected, stored, and DOM-based XSS
- **Command Injection** - OS command execution detection
- **Path Traversal** - Local file inclusion testing
- **NoSQL Injection** - MongoDB and other NoSQL databases

### üìä Reporting
- **Automated Reports** - Professional security reports
- **JSON Results** - Machine-readable findings
- **Risk Assessment** - Severity-based prioritization

## Usage Examples

### Basic Security Scan
```bash
# Test a public example (for learning)
./pentest-toolkit --target https://example.com --mode quick

# Test your local development server (SAFE FOR LEARNING)
./pentest-toolkit --target http://localhost:3000 --mode quick

# Test with specific port
./pentest-toolkit --target http://127.0.0.1:8080 --mode quick
```
Runs essential tests:
- Endpoint enumeration
- SQL injection testing
- XSS testing

### Comprehensive Assessment
```bash
./pentest-toolkit --target https://example.com --mode comprehensive
```
Runs full security assessment:
- Complete attack surface discovery
- All vulnerability tests
- Detailed reporting

### API Testing
```bash
# Test API endpoints
./pentest-toolkit --target https://api.example.com --mode api

# Test local API
./pentest-toolkit --target http://localhost:5000/api --mode api
```
Focuses on API-specific vulnerabilities.

### Individual Tests
```bash
# Test only for SQL injection
./pentest-toolkit --target https://example.com --mode sql

# Test only for XSS
./pentest-toolkit --target https://example.com --mode xss

# Enumerate endpoints only
./pentest-toolkit --target https://example.com --mode endpoints

# Scan ports only
./pentest-toolkit --target https://example.com --mode ports
```

### uv-Specific Usage
```bash
# Setup uv environment
./pentest-toolkit --setup

# Force uv execution
./pentest-toolkit --target https://example.com --mode comprehensive --uv

# Use system Python (no uv)
./pentest-toolkit --target https://example.com --mode comprehensive --no-uv

# Check if uv is available
uv --version
```

### Using Individual Scripts
```bash
# Direct script execution
python3 scripts/enumerate_endpoints.py https://example.com
python3 scripts/test_sql_injection.py https://example.com/login
python3 scripts/test_xss.py https://example.com/search?q=test
python3 scripts/scan_ports.py 192.168.1.1
```

## Output Files

The toolkit generates several output files:

- `discovered_endpoints.json` - All discovered URLs and endpoints
- `sql_injection_results.json` - SQL injection test results
- `xss_results.json` - XSS test results
- `port_scan_results.json` - Open ports and services
- `security_report.md` - Comprehensive markdown report
- `security_report.json` - Machine-readable report

## Report Generation

Generate reports from previous scans:
```bash
# Generate report from all results in current directory
python3 scripts/generate_report.py

# Generate from specific result file
python3 scripts/generate_report.py sql_injection_results.json
```

## Architecture

### Self-Contained Design
- **No external dependencies** - Uses only Python standard library
- **No database required** - Results stored as JSON
- **No installation needed** - Ready to run out of the box

### Attack Knowledge Base
Built-in knowledge includes:
- 50+ SQL injection payloads
- 40+ XSS payload variations
- 1000+ common ports to scan
- Pattern-based endpoint discovery
- Vulnerability detection patterns

### AI-Guided Testing
- Intelligent payload selection
- Context-aware vulnerability detection
- Adaptive testing strategies
- Professional assessment methodology

## Responsible Usage

‚ö†Ô∏è **CRITICAL**: This toolkit is for authorized security testing ONLY.

### Requirements
- **Written Authorization**: Always get permission before testing
- **Legal Compliance**: Follow all applicable laws and regulations
- **Responsible Disclosure**: Report vulnerabilities ethically

### Best Practices
1. **Never test without permission**
2. **Use on dedicated test environments first**
3. **Review results before production deployment**
4. **Follow vendor disclosure policies**

## Troubleshooting

### Common Issues

**Permission Denied**
```bash
chmod +x pentest-toolkit
```

**Python Not Found**
```bash
# Check Python version
python3 --version

# On some systems, use:
python --version
```

**Network Timeout**
```bash
# Increase timeout or test local server
./pentest-toolkit --target http://localhost:3000 --mode quick
```

**SSL Certificate Errors**
```bash
# For local testing, HTTP works fine
./pentest-toolkit --target http://localhost:3000 --mode quick
```

### Sample Output

Quick scan produces:
```
[+] Target: http://localhost:3000
[+] Scan started: 2024-01-15 10:00:00

=== Discovery Phase ===
[+] Endpoints found: 12
[+] Technology: Node.js / Express 4.18

=== Vulnerability Testing ===
[INFO] Testing login form for SQL injection...
[INFO] Testing search parameter for XSS...

=== Summary ===
Critical: 0
High: 1
Medium: 2
Low: 5
```

## Limitations

- **Web Focus**: Optimized for web application security
- **Detection Only**: Identifies vulnerabilities, doesn't exploit
- **Linux/macOS**: Designed for Unix-like systems
- **Python 3**: Requires Python 3.8 or higher

## Comparison with Apex

| Feature | Apex | This Toolkit |
|---------|------|--------------|
| Dependencies | Bun, AI providers | Python 3 only |
| Cost | Commercial | Free & Open Source |
| AI Integration | GPT-4, Claude | Self-contained patterns |
| Container Support | Docker Kali | Local execution |
| Learning Curve | Professional | Accessible |

## Support

- **Documentation**: See `SKILL.md` for detailed information
- **Issues**: Check script outputs for error messages
- **Updates**: Regularly update for new vulnerability patterns

## Contributing

This toolkit is open for contributions:
- Add new vulnerability tests
- Improve payload collections
- Enhance reporting capabilities
- Expand platform support

Remember: Security tools should only be used for legitimate, authorized testing purposes.